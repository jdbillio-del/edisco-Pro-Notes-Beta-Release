const { contextBridge, ipcRenderer } = require("electron");

contextBridge.exposeInMainWorld("edisconotes", {
  vaultStatus: () => ipcRenderer.invoke("vault:status"),
  vaultUnlock: (passphrase) => ipcRenderer.invoke("vault:unlock", passphrase),
  vaultLock: () => ipcRenderer.invoke("vault:lock"),
  getDeadlineDashboard: () => ipcRenderer.invoke("dashboard:deadlines"),
  listProjects: (includeArchived) => ipcRenderer.invoke("projects:list", includeArchived),
  getProject: (projectId) => ipcRenderer.invoke("projects:get", projectId),
  createProject: (data) => ipcRenderer.invoke("projects:create", data),
  updateProject: (projectId, data) => ipcRenderer.invoke("projects:update", projectId, data),
  archiveProject: (projectId) => ipcRenderer.invoke("projects:archive", projectId),
  restoreProject: (projectId) => ipcRenderer.invoke("projects:restore", projectId),
  pinProject: (projectId, isPinned) => ipcRenderer.invoke("projects:pin", projectId, isPinned),
  exportProjectBundle: (projectId) => ipcRenderer.invoke("projects:exportBundle", projectId),
  importProjectBundle: () => ipcRenderer.invoke("projects:importBundle"),
  listNotes: (projectId) => ipcRenderer.invoke("notes:list", projectId),
  createNote: (projectId, data) => ipcRenderer.invoke("notes:create", projectId, data),
  updateNote: (noteId, data) => ipcRenderer.invoke("notes:update", noteId, data),
  deleteNote: (noteId) => ipcRenderer.invoke("notes:delete", noteId),
  listTodos: (projectId) => ipcRenderer.invoke("todos:list", projectId),
  createTodo: (projectId, data) => ipcRenderer.invoke("todos:create", projectId, data),
  updateTodo: (todoId, data) => ipcRenderer.invoke("todos:update", todoId, data),
  deleteTodo: (todoId) => ipcRenderer.invoke("todos:delete", todoId),
  listAttachments: (projectId) => ipcRenderer.invoke("attachments:list", projectId),
  addAttachments: (projectId, filePaths) => ipcRenderer.invoke("attachments:add", projectId, filePaths),
  openAttachment: (attachmentId) => ipcRenderer.invoke("attachments:open", attachmentId),
  previewAttachment: (attachmentId) => ipcRenderer.invoke("attachments:preview", attachmentId),
  revealAttachment: (attachmentId) => ipcRenderer.invoke("attachments:reveal", attachmentId),
  deleteAttachment: (attachmentId) => ipcRenderer.invoke("attachments:delete", attachmentId),
  searchGlobal: (query) => ipcRenderer.invoke("search:global", query),
  openExternalUrl: (targetUrl) => ipcRenderer.invoke("system:openExternal", targetUrl),
  listAuditLog: (limit, projectId) => ipcRenderer.invoke("audit:list", limit, projectId),
  backupStatus: () => ipcRenderer.invoke("backup:status"),
  createBackupSnapshot: (reason) => ipcRenderer.invoke("backup:createSnapshot", reason),
  listBackupSnapshots: (limit) => ipcRenderer.invoke("backup:listSnapshots", limit),
  restoreBackupSnapshot: (snapshotId) => ipcRenderer.invoke("backup:restoreSnapshot", snapshotId),
  exportBackup: () => ipcRenderer.invoke("backup:export"),
  restoreBackup: () => ipcRenderer.invoke("backup:restore"),
  openFileDialog: () => ipcRenderer.invoke("dialog:openFiles"),
  exportNotesDocx: (projectId) => ipcRenderer.invoke("notes:exportDocx", projectId),
  exportNotesPdf: (projectId) => ipcRenderer.invoke("notes:exportPdf", projectId),
  exportNotesMarkdown: (projectId) => ipcRenderer.invoke("notes:exportMarkdown", projectId),
  listTimelineTasks: (projectId) => ipcRenderer.invoke("timeline:list", projectId),
  upsertTimelineTask: (projectId, data) => ipcRenderer.invoke("timeline:upsert", projectId, data)
});
